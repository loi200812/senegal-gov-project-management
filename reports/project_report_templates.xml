<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Project Report Template -->
        <template id="report_government_project">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.external_layout">
                        <div class="page">
                            <div class="oe_structure"/>
                            <h2 class="text-center"><span t-field="o.name"/></h2>
                            <div class="row mt32 mb32">
                                <div class="col-6">
                                    <strong>Project:</strong> <span t-field="o.project_id"/>
                                </div>
                                <div class="col-6">
                                    <strong>Date:</strong> <span t-field="o.report_date"/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <strong>Period:</strong> <span t-field="o.period_start"/> to <span t-field="o.period_end"/>
                                </div>
                                <div class="col-6">
                                    <strong>Type:</strong> <span t-field="o.report_type"/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <strong>Status:</strong> <span t-field="o.status"/>
                                </div>
                                <div class="col-6">
                                    <strong>Generated By:</strong> <span t-field="o.generated_by_id"/>
                                </div>
                            </div>
                            <div class="row mb16">
                                <div class="col-12">
                                    <div style="position: relative;">
                                        <img t-if="o.project_id.qr_code" t-att-src="image_data_uri(o.project_id.qr_code)" style="max-height: 70px; position: absolute; right: 0; top: 0;"/>
                                    </div>
                                </div>
                            </div>
                            
                            <h4>Executive Summary</h4>
                            <div class="mb16">
                                <span t-field="o.summary"/>
                            </div>
                            
                            <h4>Report Content</h4>
                            <div class="mb16">
                                <span t-field="o.content"/>
                            </div>

                            <t t-if="o.key_achievements">
                                <h4>Key Achievements</h4>
                                <div class="mb16">
                                    <span t-field="o.key_achievements"/>
                                </div>
                            </t>

                            <t t-if="o.challenges">
                                <h4>Challenges</h4>
                                <div class="mb16">
                                    <span t-field="o.challenges"/>
                                </div>
                            </t>

                            <t t-if="o.recommendations">
                                <h4>Recommendations</h4>
                                <div class="mb16">
                                    <span t-field="o.recommendations"/>
                                </div>
                            </t>

                            <t t-if="o.next_steps">
                                <h4>Next Steps</h4>
                                <div class="mb16">
                                    <span t-field="o.next_steps"/>
                                </div>
                            </t>
                            
                            <div class="row mt32">
                                <div class="col-6">
                                    <div class="mt16">
                                        <strong>Project Progress:</strong>
                                        <div class="progress" style="height: 20px;">
                                            <div class="progress-bar" role="progressbar" t-att-style="'width: ' + str(o.project_progress) + '%'" t-att-aria-valuenow="o.project_progress" aria-valuemin="0" aria-valuemax="100">
                                                <t t-esc="o.project_progress"/>%
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="mt16">
                                        <strong>Budget Usage:</strong>
                                        <div class="progress" style="height: 20px;">
                                            <div class="progress-bar" role="progressbar" t-att-style="'width: ' + str(o.project_budget_usage) + '%'" t-att-aria-valuenow="o.project_budget_usage" aria-valuemin="0" aria-valuemax="100">
                                                <t t-esc="o.project_budget_usage"/>%
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="footer text-center mt32">
                                <t t-if="o.status == 'approved'">
                                    <div class="mt16 mb16">
                                        <strong>Approved By:</strong> <span t-field="o.approved_by_id"/> on <span t-field="o.approval_date"/>
                                    </div>
                                </t>
                                <div class="mt16">
                                    <small>Generated by the Senegal Government Project Management System</small>
                                </div>
                            </div>
                            
                            <div class="oe_structure"/>
                        </div>
                    </t>
                </t>
            </t>
        </template>
        
        <!-- QR Code Report Template -->
        <template id="report_qr_code">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.external_layout">
                        <div class="page">
                            <div class="oe_structure"/>
                            <div class="text-center">
                                <h2><span t-field="o.name"/></h2>
                                <h4><span t-field="o.model_name"/></h4>
                                <div class="mt32 mb32">
                                    <img t-att-src="image_data_uri(o.qr_code)" style="max-width: 400px;"/>
                                </div>
                                <div class="mt16">
                                    <span t-field="o.qr_code_url"/>
                                </div>
                                <div class="mt32">
                                    <p>Scan this QR code with a QR code reader application to access this record directly.</p>
                                </div>
                            </div>
                            <div class="oe_structure"/>
                        </div>
                    </t>
                </t>
            </t>
        </template>

        <!-- Project Dashboard Report Template -->
        <template id="report_project_dashboard">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.external_layout">
                        <div class="page">
                            <div class="oe_structure"/>
                            <h2 class="text-center">Project Dashboard: <span t-field="o.name"/></h2>
                            <div class="row mt32 mb32">
                                <div class="col-8">
                                    <div class="row">
                                        <div class="col-6">
                                            <strong>Code:</strong> <span t-field="o.code"/>
                                        </div>
                                        <div class="col-6">
                                            <strong>Status:</strong> <span t-field="o.state"/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <strong>Ministry:</strong> <span t-field="o.responsible_ministry_id"/>
                                        </div>
                                        <div class="col-6">
                                            <strong>Project Manager:</strong> <span t-field="o.project_manager_id"/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <strong>Strategic Axis:</strong> <span t-field="o.strategic_axis_id"/>
                                        </div>
                                        <div class="col-6">
                                            <strong>National Vision:</strong> <span t-field="o.national_vision_id"/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <strong>Planned:</strong> <span t-field="o.start_date"/> to <span t-field="o.end_date"/>
                                        </div>
                                        <div class="col-6">
                                            <strong>Actual:</strong> <span t-field="o.actual_start_date"/> to <span t-field="o.actual_end_date"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4 text-center">
                                    <img t-if="o.qr_code" t-att-src="image_data_uri(o.qr_code)" style="max-height: 150px;"/>
                                </div>
                            </div>
                            
                            <h4>Progress &amp; Budget</h4>
                            <div class="row mb16">
                                <div class="col-6">
                                    <div class="mt16">
                                        <strong>Project Progress:</strong>
                                        <div class="progress" style="height: 20px;">
                                            <div class="progress-bar" role="progressbar" t-att-style="'width: ' + str(o.progress) + '%'" t-att-aria-valuenow="o.progress" aria-valuemin="0" aria-valuemax="100">
                                                <t t-esc="o.progress"/>%
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="mt16">
                                        <strong>Budget Usage:</strong> <t t-esc="o.spent_amount"/> / <t t-esc="o.current_budget"/>
                                        <div class="progress" style="height: 20px;">
                                            <div t-att-class="'progress-bar ' + ('bg-danger' if o.budget_utilization > 90 else 'bg-success')" role="progressbar" t-att-style="'width: ' + str(o.budget_utilization) + '%'" t-att-aria-valuenow="o.budget_utilization" aria-valuemin="0" aria-valuemax="100">
                                                <t t-esc="o.budget_utilization"/>%
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <h4>Tasks</h4>
                            <table class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Task</th>
                                        <th>Assigned To</th>
                                        <th>Deadline</th>
                                        <th>Status</th>
                                        <th>Progress</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="o.task_ids" t-as="task">
                                        <tr>
                                            <td><span t-field="task.name"/></td>
                                            <td><span t-field="task.assigned_to_id"/></td>
                                            <td><span t-field="task.deadline"/></td>
                                            <td><span t-field="task.state"/></td>
                                            <td><span t-field="task.progress"/>%</td>
                                        </tr>
                                    </t>
                                    <tr t-if="not o.task_ids">
                                        <td colspan="5" class="text-center">No tasks found</td>
                                    </tr>
                                </tbody>
                            </table>

                            <t t-if="o.decision_ids">
                                <h4>Government Decisions</h4>
                                <table class="table table-sm table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Decision</th>
                                            <th>Type</th>
                                            <th>Date</th>
                                            <th>Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="o.decision_ids" t-as="decision">
                                            <tr>
                                                <td><span t-field="decision.name"/></td>
                                                <td><span t-field="decision.type"/></td>
                                                <td><span t-field="decision.date"/></td>
                                                <td><span t-field="decision.reference"/></td>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>
                            </t>

                            <t t-if="o.finance_law_allocations_ids">
                                <h4>Finance Law Allocations</h4>
                                <table class="table table-sm table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Program</th>
                                            <th>Finance Law</th>
                                            <th>Allocated</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="o.finance_law_allocations_ids" t-as="alloc">
                                            <tr>
                                                <td><span t-field="alloc.name"/></td>
                                                <td><span t-field="alloc.finance_law_id"/></td>
                                                <td><span t-field="alloc.allocated_amount"/></td>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>
                            </t>

                            <t t-if="o.impact_indicators">
                                <h4>Impact Indicators</h4>
                                <div class="mb16">
                                    <span t-field="o.impact_indicators"/>
                                </div>
                            </t>

                            <div class="mt32">
                                <p class="text-muted text-center">
                                    <small>This document was generated from the Senegal Government Project Management System</small>
                                </p>
                            </div>
                            
                            <div class="oe_structure"/>
                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>